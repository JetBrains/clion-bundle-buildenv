pkgname=libffi
pkgver=3.5.1
pkgrel=1
pkgdesc='Portable foreign function interface library'
arch=(aarch64 x86_64)
url='https://sourceware.org/libffi'
license=(MIT)
source=("https://github.com/libffi/libffi/archive/refs/tags/v$pkgver.tar.gz")
sha256sums=('ca180dccd8e26900a169efd6e09207eaa0a9be268010b8faec10476c9c4951d9')

prepare() {
  cd $pkgname-$pkgver
  autoreconf -fiv
}

build() {
  cd $pkgname-$pkgver

  ./configure \
    --prefix="$PREFIX" \
    --disable-multi-os-directory \
    --disable-static

  make -j
}

package() {
  cd $pkgname-$pkgver
  make DESTDIR="$pkgdir" install
  install -Dm644 LICENSE "${pkgdir}${PREFIX}/share/licenses/$pkgname/LICENSE"
}
